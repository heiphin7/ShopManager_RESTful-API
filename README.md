# Shop Manager RESTful API

## Описание проекта

Данный проект представляет из себя RESTful API, который предназначен для магазина. В проекте реализована система аутентификации (с помощью Spring Security), а также защищенные endpoint-ы с определенными ролями. Также реализованы CRUD (Create/Read/Update/Delet) операции для каждой из сущности: Order (заказ), Product (продукт), а еще было реализовано система архивов, то есть если заказ уже выполнен, то пользователь с ролью ROLE_ADMIN может поместить его в архив, у которого есть отдельная таблица в базе данных.

### Роли пользователей

**ROLE_USER**: В API, пользователь может только просматривать информацию о продуктах и заказах. То есть только GET-запросы к разным EndPoint-ам

**ROLE_MANAGER**: У Менеджера также имеются функции пользователя, но еще он может Изменять/Добавлять/Удалять продукты и заказы, то есть полный доступ к CRUD-операциям к таким сущностям как: Order, Product

**ROLE_ADMIN**: У Админа также есть функции Юзера и Менеджера. У админа есть доступ к операциям к сущности User, то есть админ может удалять/изменять/повышать/получать информацию о пользователях, а также у админа есть возможность отправлять заказ в архив (об этой фиче ниже)

### Тестирование

А также, проект был тестирован, с помощью программы по тестированию Postman. В одном из разделов ниже, тестирование было описано более точно

Как упоминалось выше, всего есть 3 роли со своими возможностями. USER: Пользователь может только отправлять GET - запросы на получение чего-либо, заказов и продуктов. MANAGER: У менеджера побольше возможности, он может проводить разные операции над заказами и продуктами, изменять, добавлять и удалять. ADMIN: У админа есть все возможности, такие как: возможности user-а и manager-а. А также, админ может проводить операции над пользователями и менеджерами, повышать их, удалять и завершать заказы.

# Technology Stack

## Backend 

+ Java: Основной язык программирования для разработки
+ Spring boot: Фреймворк для создания веб - приложения
+ Spring Security: Фреймворк для обеспечения аутентификации и авторизации в приложении
+ Spring Data JPA:  интерфейсы, которые можно определять для получения доступа к данным
+ Hibernate: ORM (объектно - реляционное отображение), фреймворк для работы с базой данных
+ PostreSQL: Реляционная база данных
+ Lombok: Библиотека, предоставляющая аннотации для сокращениия кода
+ Maven: Инструмент для управления зависимостями проекта

## Тестирование API

## Тестирование, используя коллекцию в Postman

В основной директории репозитория находится файл **API Testing Copy.postman_collection**, в которой хранится коллекция postman, содержащая HTTP запросы. В данном файле хранятся все ниже описанные EndPoint-ы с данными, и каждый из них работает. В каждом HTTP запросе указан его Метод(GET/POST/PUT/DELET) а также осмысленное название, которое описывает что делает данынй HTTP запрос. В сумме вышло около **16 EndPoint-ов**, которые корректно работают и имеют взаимосвязи между собой


**А также, при повторном запуске тестов, во многих запросах будут ошибки, так как в большинством из запросов это POST и DELETE, а в моем API запрещено создание одинаковых пользователей и продуктов.**

## API Endpoints 

### Product endpoints 

- **Создание нового продукта**
  - `POST /api/save/product`


- **Получение списка всех продуктов**
  - `GET /api/findAll/products`


- **Изменение/Обновление продукта по id**
  - `PUT /api/update/product/{id}`


- **Удаление продукта по id**
  - `DELETE /api/delete/product/{id}`


- **Получение продукта по id**
  - `GET /api/product/{id}`


### Order

- **Создание нового заказа**
  - `POST /api/save/order`


- **Получение списка всех продуктов**
  - `GET /api/findAll/orders`

 
- **Получение заказа по его id**
  - `GET /api/get/order/{id}`

 
- **Изменение/Обновление продукта по id**
  - `PUT /api/update/order/{id}`
 

- **Удаление продукта по id**
  - `DELETE /api/delete/order/{id}`


### Admin

- **Завершение заказа по его id**
  - `PUT /admin/complete/order/{id}`


- **Получение списка всех пользователей**
  - `GET /admin/findAll/users`

 
- **Получение пользователя по id**
  - `GET /admin/find/user/{id}`
 

- **Установки роли MANAGER для указанного пользователя**
  - `PUT /admin/set/manager/{id}`
 

- **Установка роли ADMIN для указанного пользователя**
  - `PUT /admin/set/admin/{id}`

 
- **Удаление пользователя по id**
  - `DELETE /admin/delete/user/{id}`
 
    
## Связи и таблицы в базе данных

Здесь представлены таблицы в базе данных и взаимосвязь между ними

![alt text](https://github.com/heiphin7/ShopManager_RESTful-API/blob/master/images/DataBase.png)

## Validations

Валидаторы являются неотъемлемый частью любого ПО и не только, так как недопустимо попадание некорректных данных в БД. В данном RESTful API также была реализована валидация данных для отправки данных.

Все ниже описанные валидаторы касаются только создания(POST) и изменения(PUT). **Каждое из условий (валидаторов) ниже реализованы в API и корректно обрабатывают ошибки**

#### Product
  - Все поля должны быть заполнены
  - Такой продукт не должнен существовать в базе данных (все продукты уникальные)
  - Цена продукта не должна быть отрицательным
  - Описание продукта должно быть от 15 до 100 символов

#### Order
  - Все поля должны быть заполнены
  - Список продуктов не должно быть пустым
  - Цена не должна устанавливаться вручную (Цена высчитывается автоматический)
  - Все продукты из списка продуктов должно
  - Статус продукта должен быть либо 

#### User
  - Все поля должны быть заполнены
  - Имя пользователя не должен повторяться
  - email должен быть правильного формата
  - Пароль и его подтверждение должны совпадать

## Установка и запуск

1. Первым делом создадите папку для проекта и перейдите к ней. **Откройте командную строку и введите**:

   ```bash
    git clone https://github.com/yourusername/yourproject.git
    ```
   
2. **Настройка базы данных**
   
   Создайте базу данных, и настройте подключение к ней в application.yaml

4. **Установка Зависимостей/Сборка проекта**
   
   ```bash
   mvn install
   ```

6. **Запуск приложения**:
   
    Вы можете запустить проект, используя ваше IDE, ну или используя командную строку:
   
    ```bash
    cd yourproject
    mvn spring-boot:run
    ```

    После этого, введите команду для базы данных:
    Данная команда нужна для удаления ключей уникальности для order_products, так как там у нас есть уникальные значения, а он нам не нужны, так как в разных заказах может использоваться одинаковые продукты
    ```bash
    ALTER TABLE order_products DROP CONSTRAINT uk_kcqj8vki330hducl9i221jq1d;
    ```


